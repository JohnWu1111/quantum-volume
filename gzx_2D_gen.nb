(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    447762,      13227]
NotebookOptionsPosition[    435094,      12999]
NotebookOutlinePosition[    435540,      13017]
CellTagsIndexPosition[    435497,      13014]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"p", "=", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {
       RowBox[{"a", "+", 
        RowBox[{"I", " ", "b"}]}]},
      {"c"}
     }], ")"}], "/", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"a", "^", "2"}], "+", 
     RowBox[{"b", "^", "2"}], "+", 
     RowBox[{"c", "^", "2"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.909974053592593*^9, 3.9099740684696026`*^9}, {
  3.9099741581881776`*^9, 3.909974220333045*^9}, {3.9099742609104166`*^9, 
  3.909974268549471*^9}},
 CellLabel->
  "In[676]:=",ExpressionUUID->"e7a6c840-1686-42b7-9dc8-7e91368666aa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    FractionBox[
     RowBox[{"a", "+", 
      RowBox[{"\[ImaginaryI]", " ", "b"}]}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["b", "2"], "+", 
       SuperscriptBox["c", "2"]}]]], "}"}], ",", 
   RowBox[{"{", 
    FractionBox["c", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["b", "2"], "+", 
       SuperscriptBox["c", "2"]}]]], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.909974270742527*^9},
 CellLabel->
  "Out[676]=",ExpressionUUID->"22929584-8bd9-4565-a42d-d97023aa1292"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"H", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"(", GridBox[{
     {
      RowBox[{"z", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "-", 
       RowBox[{"I", " ", 
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], 
      RowBox[{"-", 
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}
    }], ")"}]}]], "Input",
 CellChangeTimes->{{3.909973130082616*^9, 3.9099731334405384`*^9}, {
  3.9099731845384407`*^9, 3.909973252084243*^9}, {3.9099744133438735`*^9, 
  3.909974456401765*^9}},
 CellLabel->
  "In[667]:=",ExpressionUUID->"e2eab8ba-6388-4e37-884e-0591bf1f51ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], ",", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ",", 
     RowBox[{"-", 
      RowBox[{"z", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9099732378836017`*^9, 3.9099732529384966`*^9}},
 CellLabel->
  "Out[667]=",ExpressionUUID->"552d21da-2b8c-4be4-a141-1ce2b2a09693"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"expH", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], " ", "T", " ", 
     RowBox[{"H", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.909973374960911*^9, 3.909973428261657*^9}, {
  3.9099744379147773`*^9, 3.9099744525316935`*^9}},
 CellLabel->
  "In[670]:=",ExpressionUUID->"c9041d8e-f6ed-480e-8990-c6a00dbb2b30"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], "-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], ")"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.9099734164958324`*^9, 3.909973429298489*^9}},
 CellLabel->
  "Out[670]=",ExpressionUUID->"5faf7563-17f3-46ca-9e65-813887705acc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"expHkx", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"expH", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], ",", "kx"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9099736390729184`*^9, 3.9099736929051027`*^9}, {
  3.9099744698669176`*^9, 3.909974479687604*^9}},
 CellLabel->
  "In[672]:=",ExpressionUUID->"e9c22096-8678-4997-ad0b-588924952ce6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "T", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "T", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}], ")"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["y", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "T", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["y", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"T", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"T", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
           RowBox[{
            SuperscriptBox["z", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"T", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["x", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["y", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["z", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "T", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"T", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["x", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["y", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["z", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "T", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"T", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["x", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["y", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["z", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
       ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]]}], ")"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.909973667889823*^9, 3.9099736984922857`*^9},
 CellLabel->
  "Out[672]=",ExpressionUUID->"a43969a9-3ae7-424f-bd02-f901323ce258"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"expHkxT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "T", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"T", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"x", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"y", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"z", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["x", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["y", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["z", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
              RowBox[{"2", " ", "\[ImaginaryI]", " ", "T", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"T", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"x", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"y", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"z", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["x", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["y", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["z", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
             RowBox[{"3", "/", "2"}]]}], ")"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "T", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"T", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "T", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "T", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}], ")"}]}]}], "}"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.909973748288071*^9, 3.909973763219689*^9}, {
  3.9099738010054417`*^9, 3.9099738205177307`*^9}, {3.9099738639231243`*^9, 
  3.909973881455101*^9}, {3.910062679783019*^9, 3.910062682739751*^9}, {
  3.9100667818356047`*^9, 3.9100668028155107`*^9}},
 CellLabel->
  "In[774]:=",ExpressionUUID->"f8cc52bf-49f5-4ca0-94c0-fe22fbf55457"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"T", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "-", 
        FractionBox[
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", " ", "T", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"T", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["x", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["y", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["z", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ",", 
     RowBox[{"T", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], "-", 
        FractionBox[
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.9099738895681615`*^9, {3.9100626931529107`*^9, 3.910062694937106*^9}},
 CellLabel->
  "Out[774]=",ExpressionUUID->"26b4fb6e-86dc-42e8-a5fe-114517ed7b11"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UkxphiT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"expHkxT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ".", "p"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9099742873891344`*^9, 3.9099743173149676`*^9}, {
  3.9099747972305765`*^9, 3.9099747973041973`*^9}, {3.91006270078745*^9, 
  3.9100627065577497`*^9}},
 CellLabel->
  "In[775]:=",ExpressionUUID->"a9b24381-afd8-434c-88f8-d9ef274c9f18"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", " ", "T", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"T", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"x", "[", 
                  RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"y", "[", 
                  RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"z", "[", 
                  RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "a"}], "+", "b"}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"T", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"x", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"y", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"z", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"T", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"x", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"y", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"z", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}]}]}], 
          ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
      ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"T", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "a"}], "+", "b"}], ")"}],
              " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", "c", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["c", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.90997433607745*^9, 3.909974801209377*^9, 
  3.910062710161932*^9},
 CellLabel->
  "Out[775]=",ExpressionUUID->"3083f201-a647-4c0b-9698-ab5f6ed88f90"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi1rT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"T", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], "+", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", "\[ImaginaryI]", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "a"}], " ", "I"}], ")"}], 
             RowBox[{"Sin", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}]}], 
         ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["x", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["y", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["z", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["c", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.909974535219535*^9, 3.909974625281636*^9}, {
  3.90997468019337*^9, 3.909974713339167*^9}, {3.909974815051938*^9, 
  3.9099748630110655`*^9}, {3.9099749015305405`*^9, 3.9099749087366543`*^9}, {
  3.910062716962164*^9, 3.910062717233055*^9}},
 CellLabel->
  "In[776]:=",ExpressionUUID->"c4bdbde7-e576-4404-9791-e260e748304a"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"T", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.9099745467386255`*^9, 3.90997471711728*^9, 
  3.9099749099823265`*^9, 3.9099765372111444`*^9, 3.909976667893396*^9, 
  3.91006272107162*^9},
 CellLabel->
  "Out[776]=",ExpressionUUID->"f1595298-6d7c-40e5-8efd-4557727dc868"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi1iT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"I", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"T", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], ")"}]}], "+", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "a"}], " ", "I"}], ")"}], 
             RowBox[{"Cos", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"b", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}]}], 
         ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["x", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["y", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["z", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["c", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9099749165341454`*^9, 3.9099749437459292`*^9}, 
   3.910062723305719*^9},
 CellLabel->
  "In[777]:=",ExpressionUUID->"b06f1d39-1034-4b26-be1e-9e6bd09188f0"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"T", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{"a", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"b", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.9099749359758883`*^9, 3.9099749448906665`*^9}, 
   3.909976539367094*^9, 3.9099766697898507`*^9, 3.909976922760433*^9, 
   3.9100627252968435`*^9},
 CellLabel->
  "Out[777]=",ExpressionUUID->"b5cf654e-1d9b-4997-b58c-04e420ac4ffd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi1sT2", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Ukxphi1rT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "^", "2"}], "+", 
    RowBox[{
     RowBox[{"Ukxphi1iT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "^", "2"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.90997538875804*^9, 3.9099754214839735`*^9}, 
   3.909975898170828*^9, {3.9100627271009073`*^9, 3.9100627333806953`*^9}, 
   3.910062820681059*^9},
 CellLabel->
  "In[817]:=",ExpressionUUID->"0a8c1cc5-9ed1-4d07-a67e-e5d9e1346728"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["T", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"b", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], "2"]}], 
     ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["x", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["y", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["z", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], "2"]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.91006273670883*^9, 3.910062824274783*^9, 
  3.9100644435872955`*^9},
 CellLabel->
  "Out[817]=",ExpressionUUID->"e6b5ce3d-da5f-4242-a1a7-ab7375a5c0f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi2rT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"T", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "a"}], " ", "I"}], ")"}], "\[ImaginaryI]", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], ")"}]}], "-", 
        RowBox[{"c", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9099750707902985`*^9, 3.9099750889773245`*^9}, {
   3.909975153855217*^9, 3.909975173671131*^9}, {3.909975286833392*^9, 
   3.909975306264366*^9}, {3.909975726603636*^9, 3.909975727360959*^9}, 
   3.910062746882327*^9},
 CellLabel->
  "In[779]:=",ExpressionUUID->"a1d8ee37-dd76-433c-824a-38948fb50b2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9099753105416427`*^9, 3.9099754485267825`*^9, 
  3.909975730878558*^9, 3.909976543586853*^9, 3.909976672318356*^9, 
  3.9099769179981937`*^9, 3.9100627494331307`*^9},
 CellLabel->
  "Out[779]=",ExpressionUUID->"e5374958-2411-4d06-b117-732bbbf99a90"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi2iT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"-", "I"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"T", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "a"}], " ", "I"}], ")"}], 
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{"b", " ", "\[ImaginaryI]", " ", 
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "+", " ", 
           RowBox[{"\[ImaginaryI]", " ", "c", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["c", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9099753259731336`*^9, 3.90997536264758*^9}, 
   3.909975450967038*^9, 3.9099757389857965`*^9, 3.910062751738093*^9},
 CellLabel->
  "In[780]:=",ExpressionUUID->"70a06175-8e85-481d-bba4-c80833010c08"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"T", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
        RowBox[{"b", " ", 
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
        RowBox[{"c", " ", 
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.9099753636991034`*^9, 3.909975452893742*^9, 
  3.909975742331669*^9, 3.9099765442809253`*^9, 3.909976674054203*^9, 
  3.9099769160637083`*^9, 3.910062753638466*^9},
 CellLabel->
  "Out[780]=",ExpressionUUID->"089e4cdb-999d-4efa-9d66-2b79f68f0511"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi2sT2", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Ukxphi2rT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "^", "2"}], "+", 
    RowBox[{
     RowBox[{"Ukxphi2iT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "^", "2"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.909975460086194*^9, 3.90997546419153*^9}, 
   3.9099759099365625`*^9, {3.910062755463208*^9, 3.910062762411337*^9}, 
   3.910062828906782*^9},
 CellLabel->
  "In[789]:=",ExpressionUUID->"4b64ae5b-abd3-4896-92b4-67ef6c247713"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["T", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], "2"]}], 
     ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["x", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["y", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["z", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], "2"]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.910062765704906*^9, 3.910062831908306*^9},
 CellLabel->
  "Out[789]=",ExpressionUUID->"0a9ee06a-216d-4571-94ae-4bcb07901b3e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UkxphinormT2", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Ukxphi1sT2", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "+", 
    RowBox[{"Ukxphi2sT2", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.909975470140616*^9, 3.9099754920309963`*^9}, {
   3.9099759821505923`*^9, 3.9099759875585585`*^9}, {3.9100627716993093`*^9, 
   3.9100627756906843`*^9}, 3.910062836411304*^9, {3.9100651000246115`*^9, 
   3.910065101258296*^9}},
 CellLabel->
  "In[825]:=",ExpressionUUID->"e0928ebf-cff9-411f-8250-45445d2ab414"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["T", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"x", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"y", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"z", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]], "Output",
 CellChangeTimes->{3.9099754956952024`*^9, 3.9099757560734653`*^9, 
  3.909975989341833*^9, 3.91006277685629*^9, 3.9100628387556224`*^9, 
  3.9100651029219923`*^9},
 CellLabel->
  "Out[825]=",ExpressionUUID->"77b03087-f20a-4617-9114-2cce024e9815"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi1rT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi1rT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.909976452944826*^9, 3.909976551346736*^9, {3.909976687829996*^9, 
   3.9099767001477604`*^9}, {3.9100627789533067`*^9, 3.9100627800815253`*^9}},
 CellLabel->
  "In[783]:=",ExpressionUUID->"3e679b4f-0e5f-419e-baf0-5a3da26eccf1"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"T", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.90997646010581*^9, 3.909976554248643*^9, 
  3.910062782591321*^9},
 CellLabel->
  "Out[783]=",ExpressionUUID->"565a7506-dab2-4ca0-b58c-3fabbcfc8392"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi1iT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi1iT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9099764966201262`*^9, 3.9099764985060368`*^9}, 
   3.909976568326733*^9, {3.9099767604138565`*^9, 3.9099767778177013`*^9}, {
   3.910062784863281*^9, 3.9100627865051365`*^9}},
 CellLabel->
  "In[784]:=",ExpressionUUID->"d7fb2c75-b9b1-4f2d-b68f-716e95c7bfbc"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"T", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{"a", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"b", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.9099764996307697`*^9, 3.909976569469597*^9, 
  3.910062787814029*^9},
 CellLabel->
  "Out[784]=",ExpressionUUID->"199273d5-c5ed-4151-8195-ab85a6db14ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi2rT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi2rT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9099760577488813`*^9, 3.909976146179021*^9}, {
   3.9099761949044785`*^9, 3.9099762025369325`*^9}, {3.9099763231033735`*^9, 
   3.9099763703582935`*^9}, {3.9099764079707384`*^9, 3.909976414770581*^9}, 
   3.909976464784039*^9, 3.9099768830179434`*^9, {3.91006279021128*^9, 
   3.910062791819863*^9}},
 CellLabel->
  "In[785]:=",ExpressionUUID->"88ab6b9f-5efd-43ed-85ef-102fe2d35f16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.909976147392532*^9, 3.9099762038649263`*^9, {3.909976328340911*^9, 
   3.90997637131899*^9}, 3.909976416593484*^9, {3.909976466139889*^9, 
   3.909976471955865*^9}, 3.9099768840632453`*^9, 3.91006279290215*^9},
 CellLabel->
  "Out[785]=",ExpressionUUID->"4434b54c-f63e-4e27-8726-4e5c6ece84ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi2iT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi2iT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.909976864367051*^9, 3.9099768772420034`*^9}, {
  3.9100627949660273`*^9, 3.9100627966231756`*^9}},
 CellLabel->
  "In[786]:=",ExpressionUUID->"21cd12ac-a2f0-4f4d-8725-11fe31c6ff18"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"T", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
        RowBox[{"b", " ", 
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
        RowBox[{"c", " ", 
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.909976866788913*^9, 3.9099768784295945`*^9}, 
   3.9100627979732637`*^9},
 CellLabel->
  "Out[786]=",ExpressionUUID->"5a4a0088-cca8-43cc-ad39-6e03a4f1fc85"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi1sT2", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi1sT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.909976937489589*^9, 3.909976939203248*^9}, {
  3.9100628006884317`*^9, 3.9100628024490137`*^9}, {3.9100628494915*^9, 
  3.9100628567101784`*^9}},
 CellLabel->
  "In[792]:=",ExpressionUUID->"e9ba52a5-0160-467a-b3d4-c14cc01cb59d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["T", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"b", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], "2"]}], 
     ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["x", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["y", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["z", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], "2"]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.9099769404427905`*^9, 3.910062803722737*^9, 
  3.9100628585659857`*^9},
 CellLabel->
  "Out[792]=",ExpressionUUID->"36084182-26cf-4bf5-8e5d-3622061ab70e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi2sT2", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi2s", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.909976946039604*^9, 3.909976947264236*^9}, {
  3.9100628628603897`*^9, 3.9100628632116117`*^9}},
 CellLabel->
  "In[793]:=",ExpressionUUID->"0572db25-77f5-44bf-9f36-cf99487230ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["T", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], "2"]}], 
     ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["x", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["y", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["z", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], "2"]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.909976948540387*^9, 3.9100628651606345`*^9},
 CellLabel->
  "Out[793]=",ExpressionUUID->"b1a42b00-05eb-48fc-ad77-9217b901d7fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UkyphinormT2", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Ukyphi1s", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "+", 
    RowBox[{"Ukyphi2s", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9099769650089626`*^9, 3.9099769737728167`*^9}, {
  3.91006286803343*^9, 3.910062869236724*^9}},
 CellLabel->
  "In[794]:=",ExpressionUUID->"1a98a025-d2ae-4b2d-98c4-afe34c6d7894"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["T", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"x", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"y", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"z", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]], "Output",
 CellChangeTimes->{3.9099769746773453`*^9, 3.9100628699420586`*^9},
 CellLabel->
  "Out[794]=",ExpressionUUID->"809c66aa-8723-48ea-bc94-6136e0aed7bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UkxkynormT2", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukxphi1rT1", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "-", 
       RowBox[{"I", " ", 
        RowBox[{"Ukxphi1iT1", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukyphi1rT1", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"Ukyphi1iT1", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukxphi2rT1", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "-", 
       RowBox[{"I", " ", 
        RowBox[{"Ukxphi2iT1", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukyphi2rT1", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"Ukyphi2iT1", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9099771298116817`*^9, 3.909977223627058*^9}, {
  3.909977264190714*^9, 3.909977272144994*^9}, {3.9100628749816923`*^9, 
  3.910062875280697*^9}, {3.910065221312887*^9, 3.9100652312852263`*^9}},
 CellLabel->
  "In[827]:=",ExpressionUUID->"fa4e779b-79e5-40cf-aa73-429db157dda6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["T", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"x", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"y", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"z", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.909977228888668*^9, 3.909977273356348*^9, 
  3.9100628760263042`*^9, 3.910065239283654*^9},
 CellLabel->
  "Out[827]=",ExpressionUUID->"c42a15dd-592f-47eb-8e08-59b23623a67a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phit", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"expH", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ".", "p"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9100428265556946`*^9, 3.910042844336948*^9}},
 CellLabel->
  "In[736]:=",ExpressionUUID->"5a97ea3a-1d10-4a78-8fad-45bc3138966d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", 
          RowBox[{"\[ImaginaryI]", " ", "b"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "c", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"c", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "a"}], "+", "b"}], ")"}],
              " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], ")"}]}]}], ")"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "a"}], "+", "b"}], ")"}],
              " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", "c", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], ")"}]}]}], ")"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.910042847103942*^9},
 CellLabel->
  "Out[736]=",ExpressionUUID->"459ecd98-af95-4193-bf2c-82a78f650442"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phit1r", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    FractionBox["1", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["b", "2"], "+", 
       SuperscriptBox["c", "2"]}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "a", ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "c"}], " ", 
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", "b", ")"}], " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], ")"}]}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.910043003889866*^9, 3.910043031920896*^9}, {
  3.9100430703438053`*^9, 3.910043073523096*^9}},
 CellLabel->
  "In[739]:=",ExpressionUUID->"cfee9ca6-4cec-4c8f-8692-60df3a1e659e"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["a", "2"], "+", 
     SuperscriptBox["b", "2"], "+", 
     SuperscriptBox["c", "2"]}]]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"T", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c"}], " ", 
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{"b", " ", 
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9100430360352926`*^9, 3.910043074541418*^9},
 CellLabel->
  "Out[739]=",ExpressionUUID->"ddc18c55-4e6b-4ddc-96f7-687f0450f37d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phit1i", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"-", "I"}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["b", "2"], "+", 
       SuperscriptBox["c", "2"]}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", " ", "b"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "c", " ", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "a"}], ")"}], " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], ")"}]}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.910043043299695*^9, 3.9100430792094393`*^9}, {
  3.9100432669272137`*^9, 3.9100432673451605`*^9}},
 CellLabel->
  "In[744]:=",ExpressionUUID->"a8a7238e-5d15-4629-b6f2-a2c36425d612"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["a", "2"], "+", 
     SuperscriptBox["b", "2"], "+", 
     SuperscriptBox["c", "2"]}]]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"b", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"T", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", 
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.910043055484459*^9, 3.9100430803640847`*^9}, 
   3.9100432685832424`*^9},
 CellLabel->
  "Out[744]=",ExpressionUUID->"58e74de2-8457-47a7-abc9-b4dac5e765f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phit2r", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    FractionBox["1", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["b", "2"], "+", 
       SuperscriptBox["c", "2"]}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "a"}], ")"}], 
             "\[ImaginaryI]", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], ")"}]}], ")"}], 
       "/", 
       RowBox[{"(", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], ")"}]}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9100430905695095`*^9, 3.9100431859765863`*^9}},
 CellLabel->
  "In[741]:=",ExpressionUUID->"0c23df5b-76a1-4454-9a7a-7a60cf5ee61d"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["a", "2"], "+", 
     SuperscriptBox["b", "2"], "+", 
     SuperscriptBox["c", "2"]}]]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"c", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"T", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", " ", 
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9100431875204105`*^9},
 CellLabel->
  "Out[741]=",ExpressionUUID->"383feb7a-d31e-4eda-8417-b9d7bfb5a3e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phit2i", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"-", "I"}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["b", "2"], "+", 
       SuperscriptBox["c", "2"]}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "I"}], " ", "a"}], ")"}], 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"b", " ", "\[ImaginaryI]", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "c", " ", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], ")"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9100432062274776`*^9, 3.9100432603730607`*^9}},
 CellLabel->
  "In[743]:=",ExpressionUUID->"8deb9509-a998-4135-bf7d-f5695712453c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"T", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "a"}], " ", 
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{"c", " ", 
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.9100432511840754`*^9, 3.9100432631561875`*^9}},
 CellLabel->
  "Out[743]=",ExpressionUUID->"b898d70d-c736-4785-a3e3-05d3a70e5402"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"phit1r", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "^", "2"}], "+", 
   RowBox[{
    RowBox[{"phit1i", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "^", "2"}], "+", 
   RowBox[{
    RowBox[{"phit2r", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "^", "2"}], "+", 
   RowBox[{
    RowBox[{"phit2i", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "^", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9100432837282934`*^9, 3.9100433141759863`*^9}},
 CellLabel->
  "In[745]:=",ExpressionUUID->"fa2e4f7d-972d-4538-898b-c72156e3a30b"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.910043314517215*^9},
 CellLabel->
  "Out[745]=",ExpressionUUID->"4abc30a0-3016-4b7a-a9b7-f8c34680d77b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UkxphiphitrT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Ukxphi1rT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "*", 
     RowBox[{"phit1r", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ukxphi1iT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "*", 
     RowBox[{"phit1i", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ukxphi2rT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "*", 
     RowBox[{"phit2r", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ukxphi2iT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "*", 
     RowBox[{"phit2i", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.910043374687956*^9, 3.910043518927085*^9}, {
  3.9100629959927206`*^9, 3.910063029812631*^9}},
 CellLabel->
  "In[799]:=",ExpressionUUID->"cf122964-bad0-4d49-86eb-a78fe68c6435"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.9100435203291492`*^9, {3.9100629994686513`*^9, 3.9100630307848883`*^9}},
 CellLabel->
  "Out[799]=",ExpressionUUID->"69eb55bc-d258-45fe-bcca-e7bb3b56bee5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UkxphiphitiT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Ukxphi1rT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "*", 
     RowBox[{"phit1i", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Ukxphi1iT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "*", 
     RowBox[{"phit1r", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ukxphi2rT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "*", 
     RowBox[{"phit2i", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Ukxphi2iT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "*", 
     RowBox[{"phit2r", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.910043527843381*^9, {3.910043572135445*^9, 3.910043588362298*^9}, {
   3.910063003228861*^9, 3.9100630371327033`*^9}},
 CellLabel->
  "In[800]:=",ExpressionUUID->"00c85b1c-4956-4f7f-a342-55d93e77b9da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "a", " ", "c", " ", 
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
      RowBox[{"2", " ", "b", " ", "c", " ", 
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "-", 
         SuperscriptBox["c", "2"]}], ")"}], " ", 
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.9100435895604596`*^9, {3.910063021050996*^9, 3.910063038319744*^9}},
 CellLabel->
  "Out[800]=",ExpressionUUID->"d23d2bf9-d440-41d5-b9ec-38c5ba4b4fb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UkyphiphitiT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"UkxphiphitiT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9100436403763657`*^9, 3.9100436451778483`*^9}, {
  3.910063042153556*^9, 3.910063043388899*^9}},
 CellLabel->
  "In[801]:=",ExpressionUUID->"319b9136-ea47-4a3b-bd94-8dca078e1a8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "a", " ", "c", " ", 
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
      RowBox[{"2", " ", "b", " ", "c", " ", 
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "-", 
         SuperscriptBox["c", "2"]}], ")"}], " ", 
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.910043679827033*^9, 3.910063045234164*^9},
 CellLabel->
  "Out[801]=",ExpressionUUID->"9ebc8248-c454-4924-864b-c2c8e2145da5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gxxT2", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"UkxphinormT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "-", 
    RowBox[{
     RowBox[{"UkxphiphitiT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "^", "2"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9100437297801046`*^9, 3.910043796773705*^9}, {
  3.9100438669733286`*^9, 3.910043903654524*^9}, {3.9100451112373557`*^9, 
  3.9100451123349905`*^9}, {3.910063050548095*^9, 3.9100630585428705`*^9}},
 CellLabel->
  "In[802]:=",ExpressionUUID->"d7a70581-f841-4c6a-8bb7-ce8cb3a03503"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["T", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "a", " ", "c", " ", 
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
          RowBox[{"2", " ", "b", " ", "c", " ", 
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["b", "2"], "-", 
             SuperscriptBox["c", "2"]}], ")"}], " ", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["c", "2"]}], ")"}], "2"]]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["x", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["y", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["z", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"]}], ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"y", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"z", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.9100437996349926`*^9, {3.9100438876093607`*^9, 3.910043904860227*^9}, 
   3.9100451132708445`*^9, 3.910063060525032*^9},
 CellLabel->
  "Out[802]=",ExpressionUUID->"899bada6-0c33-45fb-bbc0-d3077167f361"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gyyT2", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"gxxT2", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.910044836817151*^9, 3.9100448407724214`*^9}, {
  3.910063064733715*^9, 3.9100630676013117`*^9}},
 CellLabel->
  "In[803]:=",ExpressionUUID->"b9f50f2d-873b-4892-87b3-8958718e7be2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["T", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "a", " ", "c", " ", 
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
          RowBox[{"2", " ", "b", " ", "c", " ", 
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["b", "2"], "-", 
             SuperscriptBox["c", "2"]}], ")"}], " ", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["c", "2"]}], ")"}], "2"]]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["x", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["y", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["z", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"]}], ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"y", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"z", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{3.910044842911006*^9, 3.910045116260439*^9, 
  3.910063068074286*^9},
 CellLabel->
  "Out[803]=",ExpressionUUID->"21178ad6-0574-4685-a4a9-0a1b317e4fc2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gxyT2", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"UkxkynormT2", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "-", 
     RowBox[{
      RowBox[{"UkxphiphitiT1", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "*", 
      RowBox[{"UkyphiphitiT1", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T", ">", "0"}], ",", 
      RowBox[{"a", ">", "0"}], ",", 
      RowBox[{"b", ">", "0"}], ",", 
      RowBox[{"c", ">", "0"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9100448252881546`*^9, 3.910044827176093*^9}, {
   3.9100448613688717`*^9, 3.9100449931498137`*^9}, {3.910045094905141*^9, 
   3.9100450961841297`*^9}, {3.9100454082703114`*^9, 3.91004542995232*^9}, 
   3.910061686296381*^9, {3.91006307068927*^9, 3.9100630811422453`*^9}},
 CellLabel->
  "In[804]:=",ExpressionUUID->"c43547d2-90ec-4a8a-9d23-5ac627c92f80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["T", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "2"], "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "a", " ", "c", " ", 
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
          RowBox[{"2", " ", "b", " ", "c", " ", 
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["b", "2"], "-", 
             SuperscriptBox["c", "2"]}], ")"}], " ", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["c", "2"]}], ")"}], "2"]]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"y", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"z", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.910044931825675*^9, {3.910044976456949*^9, 3.91004499467807*^9}, 
   3.910045097932299*^9, {3.9100454099133587`*^9, 3.910045431268988*^9}, 
   3.9100616881294446`*^9, 3.9100630822194977`*^9},
 CellLabel->
  "Out[804]=",ExpressionUUID->"4f7a7419-50bc-49c9-93be-8b0c13f7cd50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GkxkyT4", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"Det", "[", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"gxxT2", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], 
          RowBox[{"gxyT2", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]},
         {
          RowBox[{"gxyT2", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], 
          RowBox[{"gyyT2", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}
        }], ")"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T", ">", "0"}], ",", 
      RowBox[{"a", ">", "0"}], ",", 
      RowBox[{"b", ">", "0"}], ",", 
      RowBox[{"c", ">", "0"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9100451332788367`*^9, 3.910045178700457*^9}, {
  3.910045209635457*^9, 3.9100452224722943`*^9}, {3.910063091327282*^9, 
  3.9100631052170134`*^9}},
 CellLabel->
  "In[805]:=",ExpressionUUID->"3859f49d-232b-4455-8ee7-306b7cc4722e"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.910045172330022*^9, 3.9100451821418257`*^9}, 
   3.910045226031273*^9, {3.9100454131019363`*^9, 3.9100454361321163`*^9}, 
   3.9100616906428967`*^9, 3.910063107441986*^9},
 CellLabel->
  "Out[805]=",ExpressionUUID->"e3935e4d-96ce-465d-857b-8274c32997a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"expHkxT0", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"T", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"x", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"y", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"z", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
               RowBox[{
                SuperscriptBox["z", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"T", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"x", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"y", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"z", "[", 
                    RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["x", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["y", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                  RowBox[{
                   SuperscriptBox["z", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
             RowBox[{"3", "/", "2"}]]}], ")"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", 
             RowBox[{"T", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"x", "[", 
                  RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"y", "[", 
                  RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"z", "[", 
                  RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}]}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{
               SuperscriptBox["x", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"T", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["x", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["y", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["z", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}], "/", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"T", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", 
              RowBox[{
               SuperscriptBox["x", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"T", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["x", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["y", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["z", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]]}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}], ")"}]}]}], "}"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.910063131099512*^9, 3.9100632234862046`*^9}},
 CellLabel->
  "In[806]:=",ExpressionUUID->"fe86dcde-5028-4022-bac4-33417cb03013"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                SuperscriptBox["y", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["x", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["y", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["z", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
       ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", 
              RowBox[{
               SuperscriptBox["x", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["x", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["y", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["z", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
       ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"T", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["x", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["y", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
           RowBox[{
            SuperscriptBox["z", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9100632272920456`*^9},
 CellLabel->
  "Out[806]=",ExpressionUUID->"a1026608-fc0d-40fa-a694-c92d219d9ca3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UkxphiT0", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"expHkxT0", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ".", "p"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9100632749210367`*^9, 3.910063277015875*^9}},
 CellLabel->
  "In[807]:=",ExpressionUUID->"dcf65f5b-73ec-4cd2-82df-c010d83ca018"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", 
            RowBox[{"\[ImaginaryI]", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{
                   SuperscriptBox["x", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["y", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["c", "2"]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}], ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", 
            RowBox[{"\[ImaginaryI]", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                SuperscriptBox["y", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["c", "2"]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}], ")"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.910063285298533*^9},
 CellLabel->
  "Out[807]=",ExpressionUUID->"692c017a-bad0-4829-b952-f1643219957b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi1rT0", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[ImaginaryI]", " ", "b"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], " ", 
               RowBox[{
                SuperscriptBox["x", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], " ", 
               RowBox[{
                SuperscriptBox["y", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"x", "[", 
                  RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"y", "[", 
                  RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"z", "[", 
                  RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["y", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], ")"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], " ", 
               RowBox[{
                SuperscriptBox["x", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], " ", 
               RowBox[{
                SuperscriptBox["y", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], " ", 
               RowBox[{
                SuperscriptBox["z", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.910063349079774*^9, 3.910063360293092*^9}, {
  3.9100634151651907`*^9, 3.910063452533332*^9}},
 CellLabel->
  "In[809]:=",ExpressionUUID->"1ca563a0-a5a2-4878-8457-5c840b25b7e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"T", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{"b", " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.910063433461298*^9, 3.9100634542572346`*^9}},
 CellLabel->
  "Out[809]=",ExpressionUUID->"fdc7238c-fb34-4fe0-af85-6dc9f086744e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi1iT0", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"-", "I"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"(", "a", ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"\[ImaginaryI]", " ", 
                 RowBox[{
                  SuperscriptBox["x", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["c", "2"]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.910063458513826*^9, 3.910063501471349*^9}},
 CellLabel->
  "In[810]:=",ExpressionUUID->"9890e6d0-aa12-4d6a-a73c-36f82e94d0bd"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{"a", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{"a", " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
           RowBox[{"c", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
    "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.910063503644264*^9},
 CellLabel->
  "Out[810]=",ExpressionUUID->"889314cd-ef4d-4cfd-880f-0edf3db5e275"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi2rT0", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"I", " ", "b"}], ")"}]}], " ", "\[ImaginaryI]", " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"I", " ", "b"}], ")"}], 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", "\[ImaginaryI]", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}], ")"}]}],
      ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9100635251793575`*^9, 3.910063546633283*^9}, {
  3.9100637558613887`*^9, 3.9100638198095036`*^9}},
 CellLabel->
  "In[813]:=",ExpressionUUID->"58f2460f-e254-49d8-b72b-1bc2bc299217"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"T", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.910063791034884*^9, 3.9100638211178813`*^9}},
 CellLabel->
  "Out[813]=",ExpressionUUID->"749dc8c8-840a-4f39-9447-d8a27f582795"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi2iT0", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"-", "I"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "a"}], " ", "\[ImaginaryI]", " ", 
               RowBox[{
                SuperscriptBox["x", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"I", " ", "b"}], ")"}], 
               RowBox[{
                SuperscriptBox["y", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", " ", 
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"I", " ", "b"}], ")"}], "\[ImaginaryI]", " ", 
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], " ", 
               RowBox[{
                SuperscriptBox["x", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], " ", 
               RowBox[{
                SuperscriptBox["y", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], " ", 
               RowBox[{
                SuperscriptBox["z", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"1", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
        ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["c", "2"]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9100635251793575`*^9, 3.910063528127981*^9}, 
   3.910063827634145*^9, {3.9100638658232975`*^9, 3.910063871146103*^9}, {
   3.9100639074452887`*^9, 3.9100639254924107`*^9}},
 CellLabel->
  "In[815]:=",ExpressionUUID->"00cf3253-62d2-4bd8-a13f-254b9c3d8b88"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"c", " ", 
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
    "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.9100639183072767`*^9, 3.9100639276890063`*^9}},
 CellLabel->
  "Out[815]=",ExpressionUUID->"9caedf41-bd75-4c19-b5a9-cdb62360ed6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi1rT0", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi1rT0", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9100653817198067`*^9, 3.9100653914622784`*^9}},
 CellLabel->
  "In[828]:=",ExpressionUUID->"cf41855d-21cf-4a44-b880-f8e41c80cc43"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"T", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{"b", " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.910065394693549*^9},
 CellLabel->
  "Out[828]=",ExpressionUUID->"647b2314-44a2-459b-9491-b0d813eff9e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi1iT0", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi1iT0", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9100654010373297`*^9, 3.9100654034598074`*^9}},
 CellLabel->
  "In[829]:=",ExpressionUUID->"bf7ddd52-888c-4276-9847-3466de0b28b1"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{"a", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{"a", " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
           RowBox[{"c", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
    "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9100654051736455`*^9},
 CellLabel->
  "Out[829]=",ExpressionUUID->"4f48207e-5cc5-4384-8efc-9ca19f384357"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi2rT0", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi2rT0", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.910065410953416*^9, 3.9100654128112907`*^9}},
 CellLabel->
  "In[830]:=",ExpressionUUID->"2e0fcf9b-cbbb-4512-aa1a-5123c6f43ed7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"T", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.910065413591299*^9},
 CellLabel->
  "Out[830]=",ExpressionUUID->"c4b3cefb-50c5-47ec-a08c-224cf4008fea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi2iT0", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi2iT0", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.910065419076285*^9, 3.910065423177702*^9}},
 CellLabel->
  "In[831]:=",ExpressionUUID->"b39a5424-be31-42a6-8fda-1f032c5fb897"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"c", " ", 
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["x", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
    "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9100654234685307`*^9},
 CellLabel->
  "Out[831]=",ExpressionUUID->"619888ba-fc85-42f2-9296-a0be3d59085c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi1srT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Ukxphi1rT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "*", 
    RowBox[{"Ukxphi1rT0", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9100643952212915`*^9, 3.91006442567819*^9}, {
  3.9100645211583796`*^9, 3.9100645244874887`*^9}},
 CellLabel->
  "In[819]:=",ExpressionUUID->"f8bf9742-a731-44da-9732-a0373c298cc2"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"T", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"T", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"y", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["z", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["x", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "c"}], " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{"b", " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", " ", 
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{"c", " ", 
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
            RowBox[{
             SuperscriptBox["y", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["z", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
    "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"], "+", 
        SuperscriptBox["c", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
       RowBox[{"5", "/", "2"}]]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.9100644226930027`*^9, {3.910064516925237*^9, 3.910064531505745*^9}},
 CellLabel->
  "Out[819]=",ExpressionUUID->"b707fbf7-46e9-41a1-9457-b6f7e4e60483"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi1siT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Ukxphi1iT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "*", 
    RowBox[{"Ukxphi1iT0", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9100645616641383`*^9, 3.910064565432167*^9}},
 CellLabel->
  "In[820]:=",ExpressionUUID->"5726ee9f-16e8-45c6-8eea-911e26628ecb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"T", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"z", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
     RowBox[{"5", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9100645811986723`*^9},
 CellLabel->
  "Out[820]=",ExpressionUUID->"8d1a8f7b-6896-42de-861a-d115173b3310"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi1sT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Ukxphi1srT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "+", 
    RowBox[{"Ukxphi1siT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9100645914933996`*^9, 3.910064607695031*^9}},
 CellLabel->
  "In[821]:=",ExpressionUUID->"d69019f3-0e89-4a24-b51e-bf253de8c205"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"T", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"c", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"b", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"b", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "c"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"b", " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"c", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
     RowBox[{"5", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.91006472709422*^9},
 CellLabel->
  "Out[821]=",ExpressionUUID->"aac7b292-0e36-4314-b08b-f7f023a2ba21"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi1sT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi1sT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9100647833775225`*^9, 3.9100647877571993`*^9}},
 CellLabel->
  "In[822]:=",ExpressionUUID->"da232eed-083c-4685-bd58-e663606e0adc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"T", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"y", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"c", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"b", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"b", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "c"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"b", " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"c", " ", 
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "[", 
               RowBox[{"kx", ",", "ky"}], "]"}]}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
     RowBox[{"5", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9100647893013783`*^9},
 CellLabel->
  "Out[822]=",ExpressionUUID->"af682046-c771-48bd-bc99-275a5919ca2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukxphi2sT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Ukxphi2rT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "*", 
     RowBox[{"Ukxphi2rT0", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ukxphi2iT1", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "*", 
     RowBox[{"Ukxphi2iT0", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.910064876673353*^9, 3.9100649008744063`*^9}},
 CellLabel->
  "In[823]:=",ExpressionUUID->"aaa34f81-6d69-4786-85fc-1a948e5984c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"T", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{"b", " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"b", " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"b", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
     RowBox[{"5", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.910065024671648*^9},
 CellLabel->
  "Out[823]=",ExpressionUUID->"2d56398a-67be-4e7c-9904-f0aece2c94a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ukyphi2sT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Ukxphi2sT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx_", ",", "ky_"}], "]"}], "->", " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", "All"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.910065042524234*^9, 3.9100650435656404`*^9}},
 CellLabel->
  "In[824]:=",ExpressionUUID->"fc1987a4-ee8b-4c57-9f51-29fc3710bdef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"T", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"x", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{"b", " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"b", " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"b", " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
     RowBox[{"5", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9100650447605143`*^9},
 CellLabel->
  "Out[824]=",ExpressionUUID->"e4d793c6-b991-4301-aeec-746c5c15b193"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UkxphinormT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Ukxphi1sT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "+", 
    RowBox[{"Ukxphi2sT1", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.9100651107562833`*^9},
 CellLabel->
  "In[826]:=",ExpressionUUID->"252d0f75-2e47-4586-9bf3-1935ab97587c"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.910065116748412*^9},
 CellLabel->
  "Out[826]=",ExpressionUUID->"06f1dd59-98f0-4bc4-b0f9-8cf04d0836b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UkxkynormT1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukxphi1rT1", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "-", 
       RowBox[{"I", " ", 
        RowBox[{"Ukxphi1iT1", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukyphi1rT0", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"Ukyphi1iT0", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukxphi2rT1", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "-", 
       RowBox[{"I", " ", 
        RowBox[{"Ukxphi2iT1", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukyphi2rT0", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"Ukyphi2iT0", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukxphi1rT0", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "-", 
       RowBox[{"I", " ", 
        RowBox[{"Ukxphi1iT0", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukyphi1rT1", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"Ukyphi1iT1", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukxphi2rT0", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "-", 
       RowBox[{"I", " ", 
        RowBox[{"Ukxphi2iT0", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ukyphi2rT1", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"Ukyphi2iT1", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.9100652505880833`*^9, {3.9100652972081704`*^9, 3.9100653523223433`*^9}, 
   3.9100665380862875`*^9},
 CellLabel->
  "In[840]:=",ExpressionUUID->"306d1570-8040-4f50-904f-6daf5a739359"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"\[ImaginaryI]", " ", "T", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"T", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"x", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"y", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"z", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["a", "2"], "+", 
                 SuperscriptBox["b", "2"], "-", 
                 SuperscriptBox["c", "2"]}], ")"}], " ", 
               RowBox[{
                SuperscriptBox["x", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"0", ",", "1"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "a", " ", "c", " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               SuperscriptBox["b", "2"], "-", 
               SuperscriptBox["c", "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{"2", " ", "a", " ", "c", " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"y", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"z", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            SuperscriptBox["b", "2"], "-", 
            SuperscriptBox["c", "2"]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"2", " ", "b", " ", "c", " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               SuperscriptBox["b", "2"], "-", 
               SuperscriptBox["c", "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{"2", " ", "b", " ", "c", " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"z", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{"a", " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{"a", " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "a"}], " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
               RowBox[{"b", " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "a", " ", "c", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"2", " ", "b", " ", "c", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{"2", " ", "b", " ", "c", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{"2", " ", "a", " ", "c", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"y", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
          RowBox[{
           SuperscriptBox["x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["z", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
         RowBox[{"2", " ", "b", " ", "c", " ", 
          RowBox[{
           SuperscriptBox["y", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"x", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"y", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"z", "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"T", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"x", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"y", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"z", "[", 
                   RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "a", " ", "c", " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["a", "2"], "+", 
                  SuperscriptBox["b", "2"], "-", 
                  SuperscriptBox["c", "2"]}], ")"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "a", " ", "c", " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["a", "2"], "+", 
                  SuperscriptBox["b", "2"], "-", 
                  SuperscriptBox["c", "2"]}], ")"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], "+", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"y", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "a", " ", "c", " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["a", "2"], "+", 
                  SuperscriptBox["b", "2"], "-", 
                  SuperscriptBox["c", "2"]}], ")"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "a", " ", "c", " ", 
                RowBox[{
                 SuperscriptBox["x", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["a", "2"], "+", 
                  SuperscriptBox["b", "2"], "-", 
                  SuperscriptBox["c", "2"]}], ")"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"T", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"y", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"z", "[", 
                RowBox[{"kx", ",", "ky"}], "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"z", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "b", " ", "c", " ", 
             RowBox[{
              SuperscriptBox["y", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               SuperscriptBox["b", "2"], "-", 
               SuperscriptBox["c", "2"]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["z", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SuperscriptBox["x", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "b", " ", "c", " ", 
                RowBox[{
                 SuperscriptBox["y", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["a", "2"], "+", 
                  SuperscriptBox["b", "2"], "-", 
                  SuperscriptBox["c", "2"]}], ")"}], " ", 
                RowBox[{
                 SuperscriptBox["z", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"y", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"z", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9100664306841383`*^9, 3.91006654257868*^9, 
  3.9100674031489496`*^9},
 CellLabel->
  "Out[840]=",ExpressionUUID->"47ec9110-5aca-4016-bdc3-f30cb59784f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UkxkynormT1p1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Ukxphi1rT1", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "-", 
      RowBox[{"I", " ", 
       RowBox[{"Ukxphi1iT1", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Ukyphi1rT0", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "+", 
      RowBox[{"I", " ", 
       RowBox[{"Ukyphi1iT0", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.910066439787538*^9, 3.9100664451276007`*^9}, 
   3.9100664806924243`*^9, {3.91006697995458*^9, 3.910066984207289*^9}},
 CellLabel->
  "In[839]:=",ExpressionUUID->"db705c90-6916-403f-b8ed-3d29849875ec"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.910066478412987*^9, 3.9100664831276784`*^9}, 
   3.910067392835882*^9},
 CellLabel->
  "Out[839]=",ExpressionUUID->"19198036-a560-4679-947c-b518831c562c"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.910045040743707*^9, 
  3.9100450911098557`*^9}},ExpressionUUID->"72d8f78b-76b6-4b04-b1ff-\
583f06d19437"]
},
WindowSize->{1080, 1829},
WindowMargins->{{Automatic, -1088}, {Automatic, -8}},
Magnification:>1.4 Inherited,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (2021\:5e742\:67085\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"80ded018-b3e3-4a0f-ae5f-9799805b55a1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 590, 18, 81, "Input",ExpressionUUID->"e7a6c840-1686-42b7-9dc8-7e91368666aa"],
Cell[1173, 42, 635, 21, 73, "Output",ExpressionUUID->"22929584-8bd9-4565-a42d-d97023aa1292"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1845, 68, 945, 29, 61, "Input",ExpressionUUID->"e2eab8ba-6388-4e37-884e-0591bf1f51ce"],
Cell[2793, 99, 849, 26, 46, "Output",ExpressionUUID->"552d21da-2b8c-4be4-a141-1ce2b2a09693"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3679, 130, 502, 13, 61, "Input",ExpressionUUID->"c9041d8e-f6ed-480e-8990-c6a00dbb2b30"],
Cell[4184, 145, 5549, 166, 366, "Output",ExpressionUUID->"5faf7563-17f3-46ca-9e65-813887705acc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9770, 316, 471, 12, 61, "Input",ExpressionUUID->"e9c22096-8678-4997-ad0b-588924952ce6"],
Cell[10244, 330, 30598, 839, 1222, "Output",ExpressionUUID->"a43969a9-3ae7-424f-bd02-f901323ce258"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40879, 1174, 17522, 458, 964, "Input",ExpressionUUID->"f8cc52bf-49f5-4ca0-94c0-fe22fbf55457"],
Cell[58404, 1634, 11405, 334, 646, "Output",ExpressionUUID->"26b4fb6e-86dc-42e8-a5fe-114517ed7b11"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69846, 1973, 496, 12, 61, "Input",ExpressionUUID->"a9b24381-afd8-434c-88f8-d9ef274c9f18"],
Cell[70345, 1987, 9088, 256, 397, "Output",ExpressionUUID->"3083f201-a647-4c0b-9698-ab5f6ed88f90"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79470, 2248, 5027, 137, 414, "Input",ExpressionUUID->"c4bdbde7-e576-4404-9791-e260e748304a"],
Cell[84500, 2387, 3772, 113, 174, "Output",ExpressionUUID->"f1595298-6d7c-40e5-8efd-4557727dc868"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88309, 2505, 4783, 133, 424, "Input",ExpressionUUID->"b06f1d39-1034-4b26-be1e-9e6bd09188f0"],
Cell[93095, 2640, 3780, 113, 174, "Output",ExpressionUUID->"b5cf654e-1d9b-4997-b58c-04e420ac4ffd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96912, 2758, 617, 16, 61, "Input",ExpressionUUID->"0a8c1cc5-9ed1-4d07-a67e-e5d9e1346728"],
Cell[97532, 2776, 5613, 167, 245, "Output",ExpressionUUID->"e6b5ce3d-da5f-4242-a1a7-ab7375a5c0f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103182, 2948, 4092, 120, 309, "Input",ExpressionUUID->"a1d8ee37-dd76-433c-824a-38948fb50b2a"],
Cell[107277, 3070, 3544, 110, 174, "Output",ExpressionUUID->"e5374958-2411-4d06-b117-732bbbf99a90"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110858, 3185, 3346, 98, 357, "Input",ExpressionUUID->"70a06175-8e85-481d-bba4-c80833010c08"],
Cell[114207, 3285, 2875, 88, 135, "Output",ExpressionUUID->"089e4cdb-999d-4efa-9d66-2b79f68f0511"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117119, 3378, 613, 16, 61, "Input",ExpressionUUID->"4b64ae5b-abd3-4896-92b4-67ef6c247713"],
Cell[117735, 3396, 4739, 144, 207, "Output",ExpressionUUID->"0a9ee06a-216d-4571-94ae-4bcb07901b3e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122511, 3545, 646, 15, 61, "Input",ExpressionUUID->"e0928ebf-cff9-411f-8250-45445d2ab414"],
Cell[123160, 3562, 1678, 54, 78, "Output",ExpressionUUID->"77b03087-f20a-4617-9114-2cce024e9815"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124875, 3621, 2064, 66, 180, "Input",ExpressionUUID->"3e679b4f-0e5f-419e-baf0-5a3da26eccf1"],
Cell[126942, 3689, 3698, 112, 174, "Output",ExpressionUUID->"565a7506-dab2-4ca0-b58c-3fabbcfc8392"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130677, 3806, 2093, 66, 180, "Input",ExpressionUUID->"d7fb2c75-b9b1-4f2d-b68f-716e95c7bfbc"],
Cell[132773, 3874, 3701, 112, 174, "Output",ExpressionUUID->"199273d5-c5ed-4151-8195-ab85a6db14ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136511, 3991, 2218, 68, 180, "Input",ExpressionUUID->"88ab6b9f-5efd-43ed-85ef-102fe2d35f16"],
Cell[138732, 4061, 3591, 111, 174, "Output",ExpressionUUID->"4434b54c-f63e-4e27-8726-4e5c6ece84ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142360, 4177, 2016, 65, 180, "Input",ExpressionUUID->"21cd12ac-a2f0-4f4d-8725-11fe31c6ff18"],
Cell[144379, 4244, 2785, 87, 135, "Output",ExpressionUUID->"5a4a0088-cca8-43cc-ad39-6e03a4f1fc85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147201, 4336, 2063, 66, 180, "Input",ExpressionUUID->"e9ba52a5-0160-467a-b3d4-c14cc01cb59d"],
Cell[149267, 4404, 5616, 167, 245, "Output",ExpressionUUID->"36084182-26cf-4bf5-8e5d-3622061ab70e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154920, 4576, 2012, 65, 149, "Input",ExpressionUUID->"0572db25-77f5-44bf-9f36-cf99487230ab"],
Cell[156935, 4643, 4741, 144, 207, "Output",ExpressionUUID->"b1a42b00-05eb-48fc-ad77-9217b901d7fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161713, 4792, 510, 13, 61, "Input",ExpressionUUID->"1a98a025-d2ae-4b2d-98c4-afe34c6d7894"],
Cell[162226, 4807, 1581, 52, 78, "Output",ExpressionUUID->"809c66aa-8723-48ea-bc94-6136e0aed7bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163844, 4864, 1443, 40, 191, "Input",ExpressionUUID->"fa4e779b-79e5-40cf-aa73-429db157dda6"],
Cell[165290, 4906, 2698, 89, 117, "Output",ExpressionUUID->"c42a15dd-592f-47eb-8e08-59b23623a67a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168025, 5000, 383, 10, 61, "Input",ExpressionUUID->"5a97ea3a-1d10-4a78-8fad-45bc3138966d"],
Cell[168411, 5012, 5057, 149, 285, "Output",ExpressionUUID->"459ecd98-af95-4193-bf2c-82a78f650442"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173505, 5166, 2372, 71, 339, "Input",ExpressionUUID->"cfee9ca6-4cec-4c8f-8692-60df3a1e659e"],
Cell[175880, 5239, 1927, 61, 173, "Output",ExpressionUUID->"ddc18c55-4e6b-4ddc-96f7-687f0450f37d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177844, 5305, 2536, 75, 339, "Input",ExpressionUUID->"a8a7238e-5d15-4629-b6f2-a2c36425d612"],
Cell[180383, 5382, 1932, 61, 173, "Output",ExpressionUUID->"58e74de2-8457-47a7-abc9-b4dac5e765f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182352, 5448, 2425, 73, 339, "Input",ExpressionUUID->"0c23df5b-76a1-4454-9a7a-7a60cf5ee61d"],
Cell[184780, 5523, 1880, 60, 173, "Output",ExpressionUUID->"383feb7a-d31e-4eda-8417-b9d7bfb5a3e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186697, 5588, 2045, 61, 337, "Input",ExpressionUUID->"8deb9509-a998-4135-bf7d-f5695712453c"],
Cell[188745, 5651, 1520, 49, 96, "Output",ExpressionUUID->"b898d70d-c736-4785-a3e3-05d3a70e5402"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190302, 5705, 609, 17, 61, "Input",ExpressionUUID->"fa2e4f7d-972d-4538-898b-c72156e3a30b"],
Cell[190914, 5724, 153, 3, 46, "Output",ExpressionUUID->"4abc30a0-3016-4b7a-a9b7-f8c34680d77b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191104, 5732, 1036, 29, 120, "Input",ExpressionUUID->"cf122964-bad0-4d49-86eb-a78fe68c6435"],
Cell[192143, 5763, 208, 4, 46, "Output",ExpressionUUID->"69eb55bc-d258-45fe-bcca-e7bb3b56bee5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192388, 5772, 1062, 30, 120, "Input",ExpressionUUID->"00c85b1c-4956-4f7f-a342-55d93e77b9da"],
Cell[193453, 5804, 2373, 76, 115, "Output",ExpressionUUID->"d23d2bf9-d440-41d5-b9ec-38c5ba4b4fb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195863, 5885, 2020, 65, 180, "Input",ExpressionUUID->"319b9136-ea47-4a3b-bd94-8dca078e1a8c"],
Cell[197886, 5952, 2344, 75, 115, "Output",ExpressionUUID->"9ebc8248-c454-4924-864b-c2c8e2145da5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200267, 6032, 641, 15, 61, "Input",ExpressionUUID->"d7a70581-f841-4c6a-8bb7-ce8cb3a03503"],
Cell[200911, 6049, 2992, 92, 243, "Output",ExpressionUUID->"899bada6-0c33-45fb-bbc0-d3077167f361"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203940, 6146, 2004, 65, 149, "Input",ExpressionUUID->"b9f50f2d-873b-4892-87b3-8958718e7be2"],
Cell[205947, 6213, 2936, 91, 243, "Output",ExpressionUUID->"21178ad6-0574-4685-a4a9-0a1b317e4fc2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208920, 6309, 997, 25, 120, "Input",ExpressionUUID->"c43547d2-90ec-4a8a-9d23-5ac627c92f80"],
Cell[209920, 6336, 4039, 127, 276, "Output",ExpressionUUID->"4f7a7419-50bc-49c9-93be-8b0c13f7cd50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213996, 6468, 997, 28, 81, "Input",ExpressionUUID->"3859f49d-232b-4455-8ee7-306b7cc4722e"],
Cell[214996, 6498, 305, 5, 46, "Output",ExpressionUUID->"e3935e4d-96ce-465d-857b-8274c32997a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215338, 6508, 17341, 463, 987, "Input",ExpressionUUID->"fe86dcde-5028-4022-bac4-33417cb03013"],
Cell[232682, 6973, 13366, 378, 504, "Output",ExpressionUUID->"a1026608-fc0d-40fa-a694-c92d219d9ca3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246085, 7356, 391, 10, 61, "Input",ExpressionUUID->"dcf65f5b-73ec-4cd2-82df-c010d83ca018"],
Cell[246479, 7368, 12553, 345, 506, "Output",ExpressionUUID->"692c017a-bad0-4829-b952-f1643219957b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[259069, 7718, 5788, 163, 377, "Input",ExpressionUUID->"1ca563a0-a5a2-4878-8457-5c840b25b7e3"],
Cell[264860, 7883, 3742, 120, 169, "Output",ExpressionUUID->"fdc7238c-fb34-4fe0-af85-6dc9f086744e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268639, 8008, 5992, 165, 428, "Input",ExpressionUUID->"9890e6d0-aa12-4d6a-a73c-36f82e94d0bd"],
Cell[274634, 8175, 3989, 122, 202, "Output",ExpressionUUID->"889314cd-ef4d-4cfd-880f-0edf3db5e275"]
}, Open  ]],
Cell[CellGroupData[{
Cell[278660, 8302, 4478, 129, 351, "Input",ExpressionUUID->"58f2460f-e254-49d8-b72b-1bc2bc299217"],
Cell[283141, 8433, 3729, 118, 196, "Output",ExpressionUUID->"749dc8c8-840a-4f39-9447-d8a27f582795"]
}, Open  ]],
Cell[CellGroupData[{
Cell[286907, 8556, 6605, 181, 468, "Input",ExpressionUUID->"00cf3253-62d2-4bd8-a13f-254b9c3d8b88"],
Cell[293515, 8739, 5504, 164, 235, "Output",ExpressionUUID->"9caedf41-bd75-4c19-b5a9-cdb62360ed6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[299056, 8908, 1965, 64, 180, "Input",ExpressionUUID->"cf41855d-21cf-4a44-b880-f8e41c80cc43"],
Cell[301024, 8974, 3716, 120, 169, "Output",ExpressionUUID->"647b2314-44a2-459b-9491-b0d813eff9e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[304777, 9099, 1965, 64, 180, "Input",ExpressionUUID->"bf7ddd52-888c-4276-9847-3466de0b28b1"],
Cell[306745, 9165, 3991, 122, 202, "Output",ExpressionUUID->"4f48207e-5cc5-4384-8efc-9ca19f384357"]
}, Open  ]],
Cell[CellGroupData[{
Cell[310773, 9292, 1963, 64, 180, "Input",ExpressionUUID->"2e0fcf9b-cbbb-4512-aa1a-5123c6f43ed7"],
Cell[312739, 9358, 3703, 118, 196, "Output",ExpressionUUID->"c4b3cefb-50c5-47ec-a08c-224cf4008fea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316479, 9481, 1961, 64, 180, "Input",ExpressionUUID->"b39a5424-be31-42a6-8fda-1f032c5fb897"],
Cell[318443, 9547, 5478, 164, 235, "Output",ExpressionUUID->"619888ba-fc85-42f2-9296-a0be3d59085c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[323958, 9716, 515, 13, 61, "Input",ExpressionUUID->"f8bf9742-a731-44da-9732-a0373c298cc2"],
Cell[324476, 9731, 6898, 207, 312, "Output",ExpressionUUID->"b707fbf7-46e9-41a1-9457-b6f7e4e60483"]
}, Open  ]],
Cell[CellGroupData[{
Cell[331411, 9943, 463, 12, 61, "Input",ExpressionUUID->"5726ee9f-16e8-45c6-8eea-911e26628ecb"],
Cell[331877, 9957, 6406, 204, 308, "Output",ExpressionUUID->"8d1a8f7b-6896-42de-861a-d115173b3310"]
}, Open  ]],
Cell[CellGroupData[{
Cell[338320, 10166, 464, 12, 61, "Input",ExpressionUUID->"d69019f3-0e89-4a24-b51e-bf253de8c205"],
Cell[338787, 10180, 11400, 337, 487, "Output",ExpressionUUID->"aac7b292-0e36-4314-b08b-f7f023a2ba21"]
}, Open  ]],
Cell[CellGroupData[{
Cell[350224, 10522, 1965, 64, 180, "Input",ExpressionUUID->"da232eed-083c-4685-bd58-e663606e0adc"],
Cell[352192, 10588, 11403, 337, 487, "Output",ExpressionUUID->"af682046-c771-48bd-bc99-275a5919ca2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[363632, 10930, 654, 18, 89, "Input",ExpressionUUID->"aaa34f81-6d69-4786-85fc-1a948e5984c1"],
Cell[364289, 10950, 11965, 352, 475, "Output",ExpressionUUID->"2d56398a-67be-4e7c-9904-f0aece2c94a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[376291, 11307, 1963, 64, 180, "Input",ExpressionUUID->"fc1987a4-ee8b-4c57-9f51-29fc3710bdef"],
Cell[378257, 11373, 11967, 352, 475, "Output",ExpressionUUID->"e4d793c6-b991-4301-aeec-746c5c15b193"]
}, Open  ]],
Cell[CellGroupData[{
Cell[390261, 11730, 440, 12, 61, "Input",ExpressionUUID->"252d0f75-2e47-4586-9bf3-1935ab97587c"],
Cell[390704, 11744, 153, 3, 46, "Output",ExpressionUUID->"06f1dd59-98f0-4bc4-b0f9-8cf04d0836b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[390894, 11752, 2334, 70, 293, "Input",ExpressionUUID->"306d1570-8040-4f50-904f-6daf5a739359"],
Cell[393231, 11824, 40590, 1133, 1407, "Output",ExpressionUUID->"47ec9110-5aca-4016-bdc3-f30cb59784f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[433858, 12962, 848, 23, 140, "Input",ExpressionUUID->"db705c90-6916-403f-b8ed-3d29849875ec"],
Cell[434709, 12987, 212, 4, 46, "Output",ExpressionUUID->"19198036-a560-4679-947c-b518831c562c"]
}, Open  ]],
Cell[434936, 12994, 154, 3, 40, "Input",ExpressionUUID->"72d8f78b-76b6-4b04-b1ff-583f06d19437"]
}
]
*)

(* End of internal cache information *)

